<!doctype html>
<html lang="uk">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Редактор агентів</title>
    <link rel="stylesheet" href="styles.css" />
  </head>
  <body>
    <header>
      <h1>Редактор агентів</h1>
      <p>Будуйте, перевіряйте й запускайте агентів у інтерактивному редакторі.</p>
    </header>

    <div id="statusBanner" class="status-banner" aria-live="polite" hidden></div>

    <section class="panel">
      <div class="field-group">
        <label for="agentName">Ім’я агента</label>
        <div class="agent-row">
          <select id="agentSelect">
            <option value="">— оберіть наявного —</option>
          </select>
          <button id="refreshAgents" title="Оновити список">↻</button>
        </div>
        <input id="agentName" type="text" placeholder="мій_агент" />
        <div class="agent-actions">
          <button id="loadAgent">Завантажити</button>
          <button id="newAgent">Новий</button>
          <button id="saveAgent">Зберегти</button>
          <button id="validateAgent">Перевірити агента</button>
        </div>
      </div>
      <div class="field-group">
        <label for="entryStep">Початковий крок</label>
        <select id="entryStep"></select>
      </div>
      <div class="field-group">
        <label>Завершальні кроки</label>
        <div id="endSteps"></div>
      </div>
    </section>

    <section class="workspace">
      <aside class="panel palette">
        <div class="palette-header">
          <div>
            <h2>Палітра інструментів</h2>
            <p class="muted">Перетягніть інструмент на канву, щоб створити крок.</p>
          </div>
        </div>
        <div class="step-toolbar">
          <button id="addActionStep" type="button">+ Крок дії</button>
          <button id="addDecisionStep" type="button">+ Розгалуження</button>
          <button id="addLoopStep" type="button">+ Цикл</button>
          <button id="addValidatorStep" type="button">+ Валідатор</button>
        </div>
        <div id="toolPalette" class="tool-palette"></div>
      </aside>

      <div class="canvas-stack">
        <div class="canvas-legend">
          <span>Shift + перетягування — створити перехід</span>
          <span>Перетягуйте кроки, щоб їх вирівняти</span>
        </div>
        <canvas id="graphCanvas" width="1100" height="640"></canvas>
      </div>

      <aside class="panel inspector">
        <h2>Інспектор кроку</h2>
        <div id="inspectorContent" class="inspector-content">Оберіть крок, щоб редагувати.</div>
      </aside>
    </section>

    <section class="panel">
      <div class="field-group">
        <label for="rawJson">Попередній перегляд JSON</label>
        <textarea id="rawJson" rows="6"></textarea>
      </div>
      <div class="field-group actions">
        <button id="importJson">Імпорт JSON</button>
        <button id="exportJson">Експорт JSON</button>
      </div>
    </section>

    <section id="runAgentPanel" class="panel">
      <h2>Запуск агента</h2>

      <div class="field-group">
        <label for="runAgentSelect">Агент</label>
        <select id="runAgentSelect">
          <option value="">— оберіть агента —</option>
        </select>
      </div>

      <div class="field-group">
        <label for="runAgentVars">Вхідні змінні</label>
        <div id="runAgentVars" class="var-grid"></div>
        <button id="addRunAgentVar" type="button">+ Додати змінну</button>
        <p class="muted">Список змінних автоматично підтягується з обраного агента; введіть лише значення або додайте власну змінну за потреби.</p>
      </div>

      <div class="actions">
        <button id="runAgentBtn">Запустити</button>
        <span id="runAgentStatus" class="muted" aria-live="polite"></span>
      </div>

      <div class="field-group">
        <label for="runAgentOutput">Результат</label>
        <pre id="runAgentOutput"></pre>
      </div>
    </section>

    <section class="panel">
      <h2>Граф зв’язків агентів</h2>
      <p class="muted">Візуалізація викликів між агентами та валідаторами.</p>
      <div id="agentsGraph" class="agents-graph"></div>
    </section>

    <footer>
      <p>Перетягуйте кроки для розміщення. Додавайте переходи, щоб будувати розгалуження й цикли.</p>
    </footer>

    <script src="app.js"></script>
  </body>
</html>
