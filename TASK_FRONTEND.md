Ціль

UI-редактор агентів по моделі “все — Agent”:

Inputs зліва, Locals зверху, Outputs справа.

Канва зі смугами (lanes) зліва направо.

На канву додаються агенти (всі прямокутники одного типу).

З’єднання змінних drag&drop створює links.

Окрема форма “Запуск агента” (вибір зі списку + input + output).

0) Заборони

❌ Не робити “tool selector”, “node types”, “workflow”.

✅ Є тільки агент (прямокутник) і його змінні-порти.

1) Починка падіння UI

Помилка типу:
Cannot set properties of null (setting 'innerHTML')

Файл: agentfw/web/static/app.js

Усі DOM-звернення — лише після перевірки елемента.

Якщо певний елемент відсутній — функція має return без exception.

Критерій: сторінка завантажується без помилок у console.

2) Основні екрани/режими
2.1. Список агентів

Ліворуч “Бібліотека агентів”:

завантажити GET /api/agents

пошук по назві

drag agent на канву

2.2. Редактор одного агента

Коли відкривається агент для редагування:

ліва шина: Inputs (порти)

верхня шина: Locals (порти)

права шина: Outputs (порти)

Шини — це просто список змінних з можливістю:

додати змінну

перейменувати

змінити тип

видалити (з перевіркою, що немає links)

3) Канва зі смугами (lanes)
3.1. Відображення

Канва поділена на вертикальні смуги:

Lane 1, Lane 2, Lane 3…
У смузі лежать прямокутники дочірніх агентів (children).

3.2. Додавання/переміщення

drag з бібліотеки → створює child з новим child.id і ref=agent_id

перетягування між смугами → змінює lanes[*].agents

4) Прямокутник агента (child)

На прямокутнику показати:

назва (ref agent.name)

зліва: порти inputs (маленькі кружечки/іконки)

справа: порти outputs

(опційно) індикатор “run_if є” (badge)

Важливо: ніяких “налаштувань тулів”.

5) З’єднання змінних (links)
5.1. UX

тягнемо з порта джерела → на порт приймача

створюється Link {src, dst}

5.2. Дозволені напрямки

$in.* або $local.* або childA.$out.* → childB.$in.*

child.$out.* → $out.*

$local.* → $out.* (дозволити)

5.3. Валідація типів

На MVP можна дозволити все, але показувати warning при несумісності типів.

6) Умови виконання (run_if)

На UI:

у child є поле run_if (рядок виразу)

редагується у правій панелі властивостей при виділенні child

приклад підказки: $local.needs_planning == true

7) Форма “Запуск агента”

Додати панель:

dropdown “Агент” (GET /api/agents)

textarea “Input JSON”

textarea “Locals JSON” (опційно, але треба для “default через locals”)

кнопка “Запустити”

pre “Output” + “Trace” (опційно)

Виклик:
POST /api/agents/run

8) Збереження

Кнопка “Зберегти”

PUT /api/agents/{agent_id} з повним Agent JSON

Після збереження — повідомлення “Збережено”.

9) Українська мова

Усі тексти інтерфейсу українською:

“Вхідні змінні”, “Внутрішні змінні”, “Вихідні змінні”

“Смуга”, “Умова виконання”, “З’єднання”, “Запустити”, “Зберегти”, “Бібліотека агентів”, тощо.

Acceptance Criteria (фронтенд)

 UI не падає при завантаженні.

 Можна додати/видалити/редагувати inputs/locals/outputs.

 Можна додати child агент на канву і перемістити між lanes.

 Drag&drop портів створює links і малює лінію.

 Є поле run_if для child.

 Є форма запуску агентів зі списку (input/output).

 Усе українською.