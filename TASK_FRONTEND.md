# TASK_FRONTEND_V2 — “UI строго як у вимозі: іконки змінних + drag-connect + lanes”
Гілка: main2
Ціль: повністю переробити UI під модель “єдиний Agent”, без панелей/форм “tools/nodes/steps”.

## 0) Жорсткі правила UI (НЕ обговорюється)
1) Весь інтерфейс українською.
2) Жодних панелей/секцій, яких не просили (ніяких “tools”, “steps”, “conditions list”, тощо).
3) Змінні — маленькі прямокутники:
   - INPUT/OUTPUT: 1 поле (name)
   - LOCAL: 2 поля (name + value)
4) На прямокутнику агента на канві:
   - ЗЛІВА: тільки іконки input змінних з їх назвами
   - ЗВЕРХУ: тільки іконки locals (name)
   - СПРАВА: тільки іконки output змінних з їх назвами
   - Саме з цими іконками робимо drag-connect.
5) Канва поділена на ВЕРТИКАЛЬНІ ДІЛЯНКИ (lanes/columns), виконання зліва направо.
6) Top bar кнопки (зліва направо):
   - “Новий”
   - “Завантажити” (dropdown зі списком агентів)
   - “Зберегти”
   - “Додати агента” (dropdown зі списком агентів для вставки на канву)

## 1) Файли, які треба змінити
Знайти фактичний static UI у репо (зазвичай це `agentfw/web/static/`).
Очікувані файли (якщо назви інші — змінюємо ті, що реально підключені сервером):
- `agentfw/web/static/index.html`
- `agentfw/web/static/app.js`
- `agentfw/web/static/styles.css`

ВАЖЛИВО: старий код типу `populateToolAndConditionOptions(...)` має бути ВИДАЛЕНИЙ, бо він ламає UI (innerHTML of null) при зміні DOM.

## 2) API інтеграція
UI використовує тільки:
- `GET /api/agents`
- `GET /api/agent/{name}`
- `POST /api/agent/{name}`
- `POST /api/run/{name}`

## 3) Екрани
### 3.1) Editor (головний екран)
Макет:
- TopBar (кнопки як у п.0)
- CanvasArea:
  - lanes: вертикальні колонки
  - у кожній lane — agent rectangles
- RightSide (НЕ ПАНЕЛЬ ТУЛЗІВ):
  - це “Редактор вибраного агента” (якщо на канві вибраний agent item)
  - показує:
    - ліворуч inputs (маленькі прямокутники з 1 полем name)
    - зверху locals (2 поля name/value)
    - праворуч outputs (1 поле name)

### 3.2) Runner (форма запуску агента)
Додати просту форму (можна модальне вікно або окремий блок):
- Dropdown вибору агента зі списку
- Поле вводу JSON (textarea) “Вхід”
- Кнопка “Запустити”
- Поле “Вихід” (textarea) — показати vars+log

## 4) Drag & Connect (ключова частина)
Реалізувати з нуля:
- Користувач тягне мишкою з іконки OUTPUT (або LOCAL/CTX, якщо дозволено) і кидає на іконку INPUT іншого агента.
- Під час drag показувати лінію (SVG overlay поверх canvas).
- Після drop створюється Binding:
  - from_agent_item_id + from_var
  - to_agent_item_id + to_var
- Якщо input вже підключений — замінюємо старий binding.
- Можливість видалити binding:
  - клік по лінії -> підсвітка -> Delete/Backspace видаляє.

Формат збереження bindings має співпасти з backend GraphSpec.

## 5) Lanes UX
- Відображення lanes як колонок.
- Додавання агента:
  - “Додати агента” -> вибір агента -> вставити в поточну lane (або lane 0 якщо нічого не вибрано).
- Перетягування agent rectangle між lanes (drag rectangle).
- У lane порядок зверху вниз (order).
- Візуальна “barrier” семантика не пояснюється текстом — просто є колонки.

## 6) Українська локалізація
- Усі кнопки/лейбли українською.
- Назви агентів для відображення брати з `title_ua`; якщо пусто — показати `name`.

## 7) Definition of Done
1) UI відкривається без помилок у консолі.
2) Немає жодних “tool/step/condition” панелей.
3) Можна:
   - Завантажити агента з dropdown
   - Додати на канву інших агентів
   - Створити зв’язки змінних drag&drop
   - Зберегти (POST /api/agent/{name})
   - Запустити агента через Runner і побачити результат
4) Все українською.

## 10) Definition of Done
- UI відкривається без помилок у консолі.
- Усі підписи українською.
- Є смуги (lanes), drag&drop агентів, з’єднання змінних лініями.
- Є панель редагування VarSpec та body_var.
- Є форма запуску агентів зі списком і показом output+trace.
