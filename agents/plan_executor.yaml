name: plan_executor
title_ua: Виконання плану з перевіркою
description_ua: LLM симулює виконання кроків і перевірку їх відповідності критеріям
kind: atomic
executor: llm
inputs:
  - name: завдання
  - name: кроки
  - name: критерії
  - name: max_reviews
locals:
  - name: parse_json
    value: true
  - name: prompt
    value: |
      Ти агент-"Цербер", який виконує та перевіряє план задачі.
      Завдання: {завдання}
      Кроки: {кроки}
      Критерії: {критерії}
      Максимальна кількість перевірок для одного кроку: {max_reviews}

      Для кожного кроку:
      - Опиши короткий результат виконання.
      - Порівняй із відповідним критерієм.
      - Якщо крок не проходить, врахуй, що він може бути перероблений ще раз до {max_reviews} разів.

      Поверни тільки JSON з полями:
      - executed_steps: список об'єктів {{"крок", "критерій", "результат", "коментар", "прийнято", "спроб"}}
      - passed: true/false чи пройшов увесь план перевірку
      - cerber_comment: стислий підсумок від Цербера
      - needs_retry: чи треба повторити будь-який крок
      - summary: загальний підсумок виконання
outputs:
  - name: результат
  - name: output_json
  - name: json_error
  - name: виконані_кроки
  - name: пройшло_перевірку
  - name: коментар_цербера
  - name: потрібно_повторити
  - name: результат_виконання
